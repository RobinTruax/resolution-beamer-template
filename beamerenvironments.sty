% ------------------------------- resolution v0.1.0 -----------------------------
% 
% resolution is a Neovim config for writing TeX and doing computation math.
% 
% This is a file which includes special environment definitions for the included beamer template.
% 
% Copyright (C) 2023 Roshan Truax
% 
% This program is free software: you can redistribute it and/or modify it under
% the terms of the GNU General Public License as published by the Free Software
% Foundation, either version 3 of the License, or (at your option) at any later
% version.
% 
% This program is distributed in the hope that it will be useful, but WITHOUT ANY
% WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
% PARTICULAR PURPOSE. See the GNU General Public License for more details.
% ------------------------------------------------------------------------------]

% --------------------------- Theorem Environments -----------------------------

\RequirePackage{amsthm}
\RequirePackage{thmtools}                    % Theorem tools
\RequirePackage[skins, breakable]{tcolorbox} % Theorem box

% ------------------------ Color-Changing Proof Setup --------------------------

\global\def\recentProof{theorem proof}
\renewenvironment{proof}[1][\proofname]{
    \begin{\recentProof}
}{
    \end{\recentProof}
}

% ------------------- Commands for Theorem and Proof Style ---------------------

% Theorem Style
\newcommand{\rsltntheoremstyle}[3]{

    % Create theorem style
    \declaretheoremstyle[
        headfont=\bfseries\color{#2!80!black},
        bodyfont=#3\color{rsltnText}
    ]{#1 box}

    % Create theorem box
    \tcolorboxenvironment{#1}{
        blanker, breakable, use color stack,
        left=5mm, top=2mm, bottom=2mm,
        before skip=10pt, after skip=10pt,
        pad before break = 2pt, pad after break = 2pt,
        borderline west={1pt}{0pt}{#2},
    }

}

% Proof Style
\newcommand{\rsltntheoremproof}[2]{

    % Create proof style
    \declaretheoremstyle[
        headfont=\itshape\color{#2!80!black},
        bodyfont=\normalfont\color{rsltnText},
        qed=$\square$,
    ]{#1 proof box}
    
    % Create proof box
    \tcolorboxenvironment{#1 proof}{
        blanker, breakable, use color stack,
        left=5mm, top=2mm, bottom=2mm,
        before skip=10pt, after skip=10pt,
        pad before break = 2pt, pad after break = 2pt,
        borderline west={1pt}{0pt}{#2},
    }

    \declaretheorem[
        style = #1 proof box,
        numbered = no,
        name = Proof
    ]{#1 proof}
}

% ---------------------- Definition-Style Environments -------------------------

% Definition
\AtBeginEnvironment{definition}{\setbeamerfont{block title}{series=\sffamily\color{rsltnDefinition!70!black}\bfseries}}
\rsltntheoremstyle{definition}{rsltnDefinition}{}
\declaretheorem[
    style   = definition box,
    name    = Definition,
    parent  = section,
]{definition}

% Conjecture
\AtBeginEnvironment{conjecture}{\setbeamerfont{block title}{series=\sffamily\color{rsltnConjecture!70!black}\bfseries}}
\rsltntheoremstyle{conjecture}{rsltnConjecture}{}
\declaretheorem[
    style   = conjecture box,
    name    = Conjecture,
    parent  = section,
    sibling = definition,
]{conjecture}

% Example
\AtBeginEnvironment{example}{\setbeamerfont{block title}{series=\sffamily\color{rsltnExample!70!black}\bfseries}}
\rsltntheoremstyle{example}{rsltnExample}{}
\declaretheorem[
    style   = example box,
    name    = Example,
    parent  = section,
    sibling = definition,
]{example}

% Problem
\AtBeginEnvironment{problem}{\setbeamerfont{block title}{series=\sffamily\color{rsltnProblem!70!black}\bfseries}}
\rsltntheoremstyle{problem}{rsltnProblem}{}
\declaretheorem[
    style   = problem box,
    name    = Problem,
    parent  = section,
    sibling = definition,
]{problem}

% Solution
\AtBeginEnvironment{solution}{\setbeamerfont{block title}{series=\sffamily\color{rsltnSolution!70!black}\bfseries}}
\rsltntheoremstyle{solution}{rsltnSolution}{}
\declaretheorem[
    style   = solution box,
    name    = Solution,
    parent  = section,
    sibling = definition,
]{solution}

% ------------------------ Theorem-Style Environments --------------------------

% Theorem
\AtBeginEnvironment{theorem}{\setbeamerfont{block title}{series=\sffamily\color{rsltnTheorem!70!black}\bfseries}}
\rsltntheoremstyle{theorem}{rsltnTheorem}{\itshape}
\declaretheorem[
    style       = theorem box,
    name        = Theorem,
    parent      = section,
    sibling     = definition,
    preheadhook = \global\def\recentProof{theorem proof}
]{theorem}
\AtBeginEnvironment{theorem proof}{\setbeamerfont{block title}{series=\sffamily\color{rsltnTheorem!70!black}\bfseries}}
\rsltntheoremproof{theorem}{rsltnTheorem}

% Proposition
\AtBeginEnvironment{proposition}{\setbeamerfont{block title}{series=\sffamily\color{rsltnProposition!70!black}\bfseries}}
\rsltntheoremstyle{proposition}{rsltnProposition}{\itshape}
\declaretheorem[
    style       = proposition box,
    name        = Proposition,
    parent      = section,
    sibling     = definition,
    preheadhook = \global\def\recentProof{proposition proof}
]{proposition}
\AtBeginEnvironment{proposition proof}{\setbeamerfont{block title}{series=\sffamily\color{rsltnProposition!70!black}\bfseries}}
\rsltntheoremproof{proposition}{rsltnProposition}

% Lemma
\AtBeginEnvironment{lemma}{\setbeamerfont{block title}{series=\sffamily\color{rsltnLemma!70!black}\bfseries}}
\rsltntheoremstyle{lemma}{rsltnLemma}{\itshape}
\declaretheorem[
    style       = lemma box,
    name        = Lemma,
    parent      = section,
    sibling     = definition,
    preheadhook = \global\def\recentProof{lemma proof}
]{lemma}
\AtBeginEnvironment{lemma proof}{\setbeamerfont{block title}{series=\sffamily\color{rsltnLemma!70!black}\bfseries}}
\rsltntheoremproof{lemma}{rsltnLemma}

% Corollary
\AtBeginEnvironment{corollary}{\setbeamerfont{block title}{series=\sffamily\color{rsltnCorollary!70!black}\bfseries}}
\rsltntheoremstyle{corollary}{rsltnCorollary}{\itshape}
\declaretheorem[
    style       = corollary box,
    name        = Corollary,
    parent      = section,
    sibling     = definition,
    preheadhook = \global\def\recentProof{corollary proof}
]{corollary}
\AtBeginEnvironment{corollary proof}{\setbeamerfont{block title}{series=\sffamily\color{rsltnCorollary!70!black}\bfseries}}
\rsltntheoremproof{corollary}{rsltnCorollary}

% ------------------------------------------------------------------------------
